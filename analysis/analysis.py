from __future__ import division
import numpy as np
import pandas as pd
import matplotlib as mpl
import matplotlib.pyplot as plt
import scipy.signal as sign


predicted_rates = pd.read_json('test.json')
data = [1954+7/12+x/12 for x in range(687)]

predicted_rates = [2.3492536544799805, 2.1811752319335938, 2.2943880558013916, 1.834700107574463, 1.6627827882766724, 1.0974524021148682, 1.3512643575668335, 1.2978670597076416, 2.2458221912384033, 1.998013973236084, 2.559711456298828, 2.0208933353424072, 2.386601686477661, 2.762028694152832, 3.134216547012329, 3.5557010173797607, 3.6926536560058594, 4.123856544494629, 4.027354717254639, 3.9340925216674805, 3.540100574493408, 3.7630369663238525, 3.6755237579345703, 3.584770917892456, 3.4034714698791504, 3.205972671508789, 3.0214333534240723, 2.6517679691314697, 2.8641231060028076, 2.48797869682312, 2.5203020572662354, 2.8339157104492188, 2.859760046005249, 2.96901535987854, 2.7905004024505615, 3.2037253379821777, 3.248408794403076, 3.577623128890991, 3.6190664768218994, 3.7350642681121826, 3.560051202774048, 3.679288148880005, 3.659325122833252, 3.649080991744995, 3.625877857208252, 3.2619616985321045, 3.493025779724121, 3.1258702278137207, 3.3709418773651123, 3.037233591079712, 2.991295337677002, 3.033731698989868, 3.3542187213897705, 3.6909048557281494, 3.70465087890625, 4.022366523742676, 3.7386226654052734, 4.114767074584961, 3.8926925659179688, 4.265597343444824, 4.2042036056518555, 4.737789154052734, 4.97712516784668, 5.664787769317627, 5.664787769317627, 5.962278366088867, 5.849782943725586, 5.3341546058654785, 5.515909194946289, 6.054989337921143, 5.8966875076293945, 6.039114952087402, 5.860587120056152, 5.394288063049316, 5.222240447998047, 4.347321510314941, 4.16978645324707, 3.694761276245117, 3.9551711082458496, 3.921330451965332, 3.8810107707977295, 3.5012123584747314, 3.914720058441162, 3.5414011478424072, 3.8300328254699707, 4.118664264678955, 4.70478630065918, 5.2316508293151855, 5.256219387054443, 5.376711368560791, 5.563235759735107, 6.05372953414917, 6.537744045257568, 6.514410018920898, 6.4943156242370605, 6.675786972045898, 6.634212493896484, 6.592637538909912, 6.253572940826416, 6.496004581451416, 6.93676233291626, 7.17919397354126, 7.020760536193848, 6.865567207336426, 6.607970237731934, 6.894223213195801, 6.889465808868408, 6.878230094909668, 6.968949794769287, 7.165310859680176, 7.077143669128418, 6.792184352874756, 6.305661201477051, 6.414116859436035, 6.3045783042907715, 6.290964126586914, 6.277348518371582, 5.715947151184082, 6.053494930267334, 5.987910270690918, 5.933450698852539, 5.872511386871338, 5.501124382019043, 5.523871421813965, 5.549859523773193, 5.371041774749756, 5.615437984466553, 5.859833240509033, 5.7108154296875, 5.900022506713867, 5.388606071472168, 5.072276592254639, 4.738001346588135, 4.893064498901367, 5.041647434234619, 5.135606288909912, 5.037718772888184, 4.933351039886475, 4.83699369430542, 4.542308807373047, 4.9385271072387695, 4.955381870269775, 5.266486644744873, 5.484908103942871, 5.934483051300049, 5.795557975769043, 6.145968914031982, 6.52535343170166, 7.2949113845825195, 7.872622966766357, 8.125580787658691, 8.480941772460938, 8.03975772857666, 9.55249309539795, 9.379450798034668, 9.59658432006836, 10.014607429504395, 10.33022689819336, 10.946576118469238, 11.169499397277832, 11.187616348266602, 10.514829635620117, 11.012052536010742, 11.12234115600586, 11.62280559539795, 10.980631828308105, 11.938030242919922, 12.09240436553955, 12.0626859664917, 12.032968521118164, 11.417988777160645, 10.781434059143066, 9.863588333129883, 9.729330062866211, 9.096725463867188, 9.04613971710205, 9.39220905303955, 8.587080955505371, 8.18508529663086, 7.981414794921875, 8.1770601272583, 7.876888275146484, 7.8677263259887695, 7.869104862213135, 8.072050094604492, 8.380637168884277, 8.568120956420898, 8.375150680541992, 7.785526275634766, 7.948179244995117, 7.608536720275879, 7.476938247680664, 6.81553316116333, 6.7458672523498535, 6.963972091674805, 7.536631107330322, 7.901243686676025, 8.365018844604492, 8.199257850646973, 8.542271614074707, 8.5715970993042, 8.523707389831543, 8.664424896240234, 8.613296508789062, 8.823140144348145, 8.722537994384766, 8.73405647277832, 8.239778518676758, 8.343719482421875, 8.143691062927246, 8.857624053955078, 9.472394943237305, 10.000961303710938, 9.99714469909668, 10.402936935424805, 10.898174285888672, 11.058724403381348, 11.318437576293945, 11.769997596740723, 12.347000122070312, 12.524107933044434, 12.90278148651123, 12.859230995178223, 12.428744316101074, 12.391671180725098, 12.867993354797363, 13.23219108581543, 13.107051849365234, 13.476030349731445, 14.049811363220215, 14.530909538269043, 14.84300708770752, 15.452594757080078, 15.387475967407227, 14.864471435546875, 14.622756958007812, 13.095160484313965, 12.796960830688477, 12.396357536315918, 12.498052597045898, 12.4761381149292, 12.543665885925293, 12.035654067993164, 11.831274032592773, 11.134319305419922, 10.827537536621094, 10.790620803833008, 10.743986129760742, 12.075918197631836, 12.232965469360352, 12.588339805603027, 11.856158256530762, 11.024971961975098, 9.988978385925293, 9.14807415008545, 7.947615623474121, 6.740678310394287, 6.036036491394043, 6.378057956695557, 6.921645641326904, 6.374438285827637, 5.713446617126465, 4.665520668029785, 4.609227657318115, 4.265702247619629, 3.611727476119995, 3.638936758041382, 3.7765791416168213, 4.208471775054932, 4.838690280914307, 4.636559009552002, 3.941850423812866, 4.0177693367004395, 4.389846324920654, 4.947290897369385, 5.204005241394043, 5.824656963348389, 6.547712326049805, 7.168362140655518, 7.639438629150391, 7.918666839599609, 7.798003196716309, 7.328706741333008, 7.259303569793701, 7.2060980796813965, 7.189526557922363, 7.0673112869262695, 6.954815864562988, 6.6005659103393555, 6.256034851074219, 5.709936618804932, 5.592086315155029, 5.675800323486328, 5.564428806304932, 5.562595844268799, 5.47131872177124, 5.175234794616699, 4.93432092666626, 4.802289009094238, 4.967747211456299, 5.2563796043396, 5.548251152038574, 5.632076740264893, 4.847103595733643, 4.045932292938232, 3.340683698654175, 3.1919491291046143, 3.4366278648376465, 3.1790108680725098, 3.112846612930298, 3.2514891624450684, 2.891075372695923, 2.662541627883911, 2.427528142929077, 2.7972137928009033, 3.366349697113037, 4.232975006103516, 4.990718364715576, 5.166289329528809, 5.041130542755127, 5.312625408172607, 5.693678379058838, 5.7772417068481445, 5.867284774780273, 5.992271423339844, 6.021335124969482, 5.7561469078063965, 5.6412529945373535, 5.625522136688232, 5.600071430206299, 5.629024028778076, 5.744180679321289, 5.865817070007324, 5.734929084777832, 5.888571739196777, 5.850368976593018, 5.810048580169678, 5.9712958335876465, 6.2349443435668945, 6.3793158531188965, 6.622849941253662, 6.78018045425415, 7.015870571136475, 6.758983135223389, 6.495616912841797, 6.217228889465332, 5.842916965484619, 6.060345649719238, 6.133816719055176, 5.906558513641357, 6.373442649841309, 6.4794793128967285, 6.387188911437988, 5.90796422958374, 5.56440544128418, 5.8093461990356445, 5.8721604347229, 6.5899200439453125, 7.109353065490723, 7.126490592956543, 7.014857292175293, 6.698416233062744, 6.183650016784668, 5.618188381195068, 5.052726745605469, 4.874198913574219, 5.022540092468262, 4.7677483558654785, 4.509716987609863, 3.969665050506592, 3.624699354171753, 3.1838104724884033, 3.4279239177703857, 3.681756019592285, 3.3308894634246826, 3.7212274074554443, 4.306653022766113, 4.495424270629883, 4.341781139373779, 4.4856276512146, 4.619755268096924, 4.5735344886779785, 4.530552864074707, 4.7753424644470215, 4.646550178527832, 4.613681793212891, 5.073390483856201, 4.8520121574401855, 4.63387393951416, 4.620542049407959, 4.562112808227539, 4.302116394042969, 4.042120933532715, 3.9838225841522217, 3.8263614177703857, 3.873706102371216, 3.806267023086548, 3.841231107711792, 3.6843481063842773, 3.7753634452819824, 3.863138437271118, 3.851750373840332, 3.8316352367401123, 4.118729114532471, 4.504986763000488, 4.6132707595825195, 4.721553802490234, 4.334021091461182, 4.4031081199646, 4.376271724700928, 4.455078125, 4.473601818084717, 4.399441719055176, 4.536566734313965, 4.513515472412109, 4.199453830718994, 3.88863205909729, 3.7206437587738037, 3.6485788822174072, 3.9731671810150146, 3.729763984680176, 3.582284450531006, 3.7322943210601807, 3.7650110721588135, 3.9001309871673584, 4.038490295410156, 4.198047161102295, 4.248722076416016, 4.6130852699279785, 4.508828163146973, 4.619096755981445, 4.626962184906006, 4.971383094787598, 5.011833190917969, 4.7515549659729, 4.760675430297852, 4.574708938598633, 4.28633975982666, 3.9554028511047363, 4.030838489532471, 3.901468276977539, 3.9386794567108154, 3.982370138168335, 3.9171783924102783, 3.5838634967803955, 3.4553539752960205, 3.3203654289245605, 3.1478829383850098, 3.1769661903381348, 3.1898508071899414, 3.4287800788879395, 3.3702194690704346, 3.3084194660186768, 3.2126271724700928, 3.120074510574341, 3.1202054023742676, 3.2180933952331543, 3.418384552001953, 3.615435838699341, 3.497039556503296, 3.5672504901885986, 4.142996788024902, 3.9245758056640625, 3.811797857284546, 3.894106149673462, 4.0835747718811035, 4.375446319580078, 4.366588115692139, 4.3767008781433105, 4.482738018035889, 4.492850303649902, 4.933477401733398, 5.466787338256836, 4.707736015319824, 4.936979293823242, 5.556396484375, 5.679996967315674, 5.252033710479736, 5.211003303527832, 4.978126525878906, 4.844413757324219, 4.710700511932373, 4.8841962814331055, 4.619575023651123, 3.9615399837493896, 4.295137405395508, 4.436572551727295, 3.8935840129852295, 3.2481918334960938, 3.207347869873047, 3.0608601570129395, 2.5241992473602295, 2.3008904457092285, 1.978418231010437, 1.4511396884918213, 1.5871005058288574, 2.1197142601013184, 2.3613178730010986, 1.963672161102295, 1.8667560815811157, 2.2656564712524414, 2.6509218215942383, 2.4444468021392822, 3.031278371810913, 3.2124876976013184, 3.390458106994629, 3.558708429336548, 3.912531614303589, 3.866462230682373, 3.030327081680298, 2.9771018028259277, 3.0262796878814697, 3.0657379627227783, 3.2976224422454834, 3.5327465534210205, 3.3679776191711426, 3.291266441345215, 3.5152852535247803, 3.643380641937256, 3.447432041168213, 3.4595296382904053, 4.053647518157959, 4.824481010437012, 5.000334739685059, 4.677132606506348, 4.288758754730225, 4.00278902053833, 4.612527370452881, 4.871944427490234, 4.638784408569336, 4.303222179412842, 4.362644195556641, 4.511509895324707, 4.964344501495361, 4.242242336273193, 3.916792631149292, 4.586215496063232, 4.9717631340026855, 6.057933807373047, 5.653415203094482, 4.826399803161621, 4.6902875900268555, 5.245078086853027, 4.867395877838135, 4.681560039520264, 4.796454429626465, 5.461513519287109, 5.534832954406738, 5.313902854919434, 4.929892539978027, 3.1511168479919434, 2.2680504322052, 2.9901530742645264, 3.5074498653411865, 3.1419966220855713, 3.307027816772461, 3.5712220668792725, 3.2469167709350586, 3.3956515789031982, 3.454942226409912, 3.21350359916687, 2.8799049854278564, 3.742746114730835, 4.503183841705322, 5.248173713684082, 5.011249542236328, 5.161259651184082, 4.77513313293457, 4.696215629577637, 4.508416175842285, 4.788527011871338, 5.557974815368652, 6.129095077514648, 5.811269760131836, 5.186233997344971, 3.8800151348114014, 1.0350735187530518, -0.21677634119987488, -0.576156497001648, -0.4391622245311737, -1.098713994026184, -1.4640158414840698, -2.113454580307007, -2.276796817779541, -3.038357973098755, -2.352494716644287, -2.060044527053833, -0.8751246333122253, 1.446488380432129, 2.6805453300476074, 2.919729232788086, 2.6306629180908203, 3.0389795303344727, 3.14656662940979, 3.06436824798584, 2.291267156600952, 2.5162782669067383, 2.460805654525757, 2.5012569427490234, 2.637631416320801, 2.5120999813079834, 2.853226661682129, 2.906583309173584, 3.3047733306884766, 3.8053677082061768, 4.2100372314453125, 4.576483249664307, 4.552755355834961, 4.522548675537109, 4.668064117431641, 4.714416027069092, 4.258471965789795, 4.209011554718018, 3.865300416946411, 3.815840005874634, 3.9360694885253906, 3.8547329902648926, 3.5783092975616455, 2.954115152359009, 2.9249000549316406, 2.598195791244507, 2.881209373474121, 3.157743215560913, 3.3448338508605957, 2.820216417312622, 2.6028084754943848, 2.3821609020233154, 2.772465229034424, 2.2735402584075928, 1.883497953414917, 2.147409677505493, 2.5137245655059814, 2.6752328872680664, 2.249213695526123, 2.0247602462768555, 1.899470567703247, 2.197071075439453, 2.597074508666992, 2.8019914627075195, 2.2037923336029053, 2.4948229789733887, 2.872058153152466, 3.0779671669006348, 3.1782331466674805, 3.189056158065796, 2.949995517730713, 2.9987058639526367, 3.0506553649902344, 2.6021835803985596, 2.0448288917541504, 1.1005408763885498, 1.3123306035995483, 1.3322733640670776, 1.3489762544631958, 1.4988551139831543, 1.539851427078247, 1.5840872526168823, 1.479719638824463, 1.1770254373550415, 1.2742242813110352, 1.5290157794952393, 1.6846438646316528, 2.3328487873077393, 1.8620351552963257, 1.6919512748718262, 1.8161176443099976, 1.6926275491714478, 1.6844996213912964, 1.4715659618377686, 1.8016414642333984, 2.2341198921203613, 2.362628936767578, 2.4880294799804688, 2.9238791465759277, 3.3597280979156494, 3.57279372215271, 3.286802291870117, 3.1032140254974365, 2.8260810375213623, 2.55218768119812, 2.6749472618103027, 2.886626720428467, 3.1877496242523193, 2.996295690536499, 3.2260847091674805, 3.158383369445801, 3.189844846725464]

ground_truths = [2.44, 1.98, 1.45, 2.54, 2.02, 1.49, 1.98, 1.73, 1.17, 2.0, 1.88, 2.26, 2.61, 2.33, 2.15, 2.37, 2.85, 2.78, 2.36, 2.68, 2.71, 2.93, 2.9, 2.9, 2.94, 2.93, 2.92, 3.0, 2.98, 2.9, 3.0, 2.99, 3.02, 3.49, 3.48, 3.5, 3.48, 3.38, 3.48, 3.48, 3.43, 3.47, 3.5, 3.5, 3.42, 3.5, 3.45, 3.36, 3.52, 3.85, 3.9, 3.98, 4.04, 4.09, 4.1, 4.04, 4.09, 4.12, 4.01, 4.08, 4.1, 4.32, 4.42, 4.6, 4.65, 4.67, 4.9, 5.17, 5.3, 5.53, 5.4, 5.53, 5.76, 5.4, 4.94, 5.0, 4.53, 4.05, 3.94, 3.98, 3.79, 3.9, 3.99, 3.88, 4.13, 4.51, 4.6, 4.71, 5.05, 5.76, 6.11, 6.07, 6.02, 6.03, 5.78, 5.91, 5.82, 6.02, 6.3, 6.61, 6.79, 7.41, 8.67, 8.9, 8.61, 9.19, 9.15, 9.0, 8.85, 8.97, 8.98, 8.98, 7.76, 8.1, 7.94, 7.6, 7.21, 6.61, 6.29, 6.2, 5.6, 4.9, 4.14, 3.72, 3.71, 4.15, 4.63, 4.91, 5.31, 5.56, 5.55, 5.2, 4.91, 4.14, 3.5, 3.29, 3.83, 4.17, 4.27, 4.46, 4.55, 4.8, 4.87, 5.04, 5.06, 5.33, 5.94, 6.58, 7.09, 7.12, 7.84, 8.49, 10.4, 10.5, 10.78, 10.01, 10.03, 9.95, 9.65, 8.97, 9.35, 10.51, 11.31, 11.93, 12.92, 12.01, 11.34, 10.06, 9.45, 8.53, 7.13, 6.24, 5.54, 5.49, 5.22, 5.55, 6.1, 6.14, 6.24, 5.82, 5.22, 5.2, 4.87, 4.77, 4.84, 4.82, 5.29, 5.48, 5.31, 5.29, 5.25, 5.02, 4.95, 4.65, 4.61, 4.68, 4.69, 4.73, 5.35, 5.39, 5.42, 5.9, 6.14, 6.47, 6.51, 6.56, 6.7, 6.78, 6.79, 6.89, 7.36, 7.6, 7.81, 8.04, 8.45, 8.96, 9.76, 10.03, 10.07, 10.06, 10.09, 10.01, 10.24, 10.29, 10.47, 10.94, 11.43, 13.77, 13.18, 13.78, 13.82, 14.13, 17.19, 17.61, 10.98, 9.47, 9.03, 9.61, 10.87, 12.81, 15.85, 18.9, 19.08, 15.93, 14.7, 15.72, 18.52, 19.1, 19.04, 17.82, 15.87, 15.08, 13.31, 12.37, 13.22, 14.78, 14.68, 14.94, 14.45, 14.15, 12.59, 10.12, 10.31, 9.71, 9.2, 8.95, 8.68, 8.51, 8.77, 8.8, 8.63, 8.98, 9.37, 9.56, 9.45, 9.48, 9.34, 9.47, 9.56, 9.59, 9.91, 10.29, 10.32, 11.06, 11.23, 11.64, 11.3, 9.99, 9.43, 8.38, 8.35, 8.5, 8.58, 8.27, 7.97, 7.53, 7.88, 7.9, 7.92, 7.99, 8.05, 8.27, 8.14, 7.86, 7.48, 6.99, 6.85, 6.92, 6.56, 6.17, 5.89, 5.85, 6.04, 6.91, 6.43, 6.1, 6.13, 6.37, 6.85, 6.73, 6.58, 6.73, 7.22, 7.29, 6.69, 6.77, 6.83, 6.58, 6.58, 6.87, 7.09, 7.51, 7.75, 8.01, 8.19, 8.3, 8.35, 8.76, 9.12, 9.36, 9.85, 9.84, 9.81, 9.53, 9.24, 8.99, 9.02, 8.84, 8.55, 8.45, 8.23, 8.24, 8.28, 8.26, 8.18, 8.29, 8.15, 8.13, 8.2, 8.11, 7.81, 7.31, 6.91, 6.25, 6.12, 5.91, 5.78, 5.9, 5.82, 5.66, 5.45, 5.21, 4.81, 4.43, 4.03, 4.06, 3.98, 3.73, 3.82, 3.76, 3.25, 3.3, 3.22, 3.1, 3.09, 2.92, 3.02, 3.03, 3.07, 2.96, 3.0, 3.04, 3.06, 3.03, 3.09, 2.99, 3.02, 2.96, 3.05, 3.25, 3.34, 3.56, 4.01, 4.25, 4.26, 4.47, 4.73, 4.76, 5.29, 5.45, 5.53, 5.92, 5.98, 6.05, 6.01, 6.0, 5.85, 5.74, 5.8, 5.76, 5.8, 5.6, 5.56, 5.22, 5.31, 5.22, 5.24, 5.27, 5.4, 5.22, 5.3, 5.24, 5.31, 5.29, 5.25, 5.19, 5.39, 5.51, 5.5, 5.56, 5.52, 5.54, 5.54, 5.5, 5.52, 5.5, 5.56, 5.51, 5.49, 5.45, 5.49, 5.56, 5.54, 5.55, 5.51, 5.07, 4.83, 4.68, 4.63, 4.76, 4.81, 4.74, 4.74, 4.76, 4.99, 5.07, 5.22, 5.2, 5.42, 5.3, 5.45, 5.73, 5.85, 6.02, 6.27, 6.53, 6.54, 6.5, 6.52, 6.51, 6.51, 6.4, 5.98, 5.49, 5.31, 4.8, 4.21, 3.97, 3.77, 3.65, 3.07, 2.49, 2.09, 1.82, 1.73, 1.74, 1.73, 1.75, 1.75, 1.75, 1.73, 1.74, 1.75, 1.75, 1.34, 1.24, 1.24, 1.26, 1.25, 1.26, 1.26, 1.22, 1.01, 1.03, 1.01, 1.01, 1.0, 0.98, 1.0, 1.01, 1.0, 1.0, 1.0, 1.03, 1.26, 1.43, 1.61, 1.76, 1.93, 2.16, 2.28, 2.5, 2.63, 2.79, 3.0, 3.04, 3.26, 3.5, 3.62, 3.78, 4.0, 4.16, 4.29, 4.49, 4.59, 4.79, 4.94, 4.99, 5.24, 5.25, 5.25, 5.25, 5.25, 5.24, 5.25, 5.26, 5.26, 5.25, 5.25, 5.25, 5.26, 5.02, 4.94, 4.76, 4.49, 4.24, 3.94, 2.98, 2.61, 2.28, 1.98, 2.0, 2.01, 2.0, 1.81, 0.97, 0.39, 0.16, 0.15, 0.22, 0.18, 0.15, 0.18, 0.21, 0.16, 0.16, 0.15, 0.12, 0.12, 0.12, 0.11, 0.13, 0.16, 0.2, 0.2, 0.18, 0.18, 0.19, 0.19, 0.19, 0.19, 0.18, 0.17, 0.16, 0.14, 0.1, 0.09, 0.09, 0.07, 0.1, 0.08, 0.07, 0.08, 0.07, 0.08, 0.1, 0.13, 0.14, 0.16, 0.16, 0.16, 0.13, 0.14, 0.16, 0.16, 0.16, 0.14, 0.15, 0.14, 0.15, 0.11, 0.09, 0.09, 0.08, 0.08, 0.09, 0.08, 0.09, 0.07, 0.07, 0.08, 0.09, 0.09, 0.1, 0.09, 0.09, 0.09, 0.09, 0.09, 0.12, 0.11, 0.11, 0.11, 0.12, 0.12, 0.13, 0.13, 0.14, 0.14, 0.12, 0.12, 0.24, 0.34, 0.38, 0.36, 0.37, 0.37, 0.38, 0.39, 0.4, 0.4, 0.4, 0.41, 0.54, 0.65, 0.66, 0.79, 0.9, 0.91, 1.04, 1.15, 1.16, 1.15, 1.15, 1.16, 1.3, 1.41]

tays = [2.0, 1.5, 1.9500000000000002, 1.1999999999999993, 1.1999999999999993, 0.5, 0.40000000000000036, 0.14999999999999947, 1.0999999999999996, 0.9000000000000004, 1.3999999999999995, 0.5499999999999998, 0.9500000000000002, 1.0499999999999998, 1.25, 2.0, 1.9000000000000004, 2.3500000000000005, 2.45, 2.45, 2.0999999999999996, 2.25, 2.3500000000000005, 2.55, 2.25, 2.45, 2.25, 1.5999999999999996, 2.25, 1.7999999999999998, 1.5999999999999996, 2.3500000000000005, 2.3500000000000005, 2.55, 2.0, 2.45, 2.25, 2.9000000000000004, 2.8000000000000007, 3.0, 2.55, 2.6500000000000004, 2.8500000000000005, 2.75, 3.05, 2.5, 2.8500000000000005, 2.4000000000000004, 3.1500000000000004, 2.5, 2.5999999999999996, 2.4000000000000004, 3.25, 3.6000000000000005, 3.8000000000000007, 4.25, 4.0, 4.449999999999999, 4.1000000000000005, 4.6499999999999995, 4.300000000000001, 4.85, 4.85, 6.1000000000000005, 6.1000000000000005, 6.55, 6.449999999999999, 5.95, 6.3999999999999995, 7.45, 7.55, 7.999999999999999, 8.1, 7.45, 7.35, 6.3999999999999995, 6.3999999999999995, 5.95, 6.3999999999999995, 6.299999999999999, 6.3999999999999995, 5.8, 6.3999999999999995, 5.6, 6.15, 6.7, 7.7, 8.2, 8.149999999999999, 8.35, 8.35, 8.600000000000001, 9.05, 9.25, 9.35, 9.65, 9.65, 9.65, 9.200000000000001, 9.65, 10.4, 10.85, 10.85, 10.75, 10.600000000000001, 11.05, 10.850000000000001, 10.850000000000001, 11.350000000000001, 11.8, 11.4, 10.95, 10.299999999999999, 10.549999999999999, 10.2, 10.1, 10.0, 9.000000000000002, 9.15, 8.899999999999999, 8.499999999999998, 8.299999999999999, 8.049999999999999, 7.6, 7.050000000000001, 6.4, 6.7, 6.999999999999999, 6.6000000000000005, 6.8, 6.1499999999999995, 5.8999999999999995, 4.949999999999999, 4.949999999999999, 5.1499999999999995, 5.55, 5.45, 5.55, 5.1000000000000005, 4.3500000000000005, 4.75, 4.75, 5.300000000000001, 5.5, 6.250000000000001, 5.8999999999999995, 6.5, 6.85, 7.999999999999999, 8.649999999999999, 9.35, 10.1, 9.75, 12.3, 12.3, 13.1, 13.650000000000002, 14.149999999999999, 15.000000000000002, 15.8, 16.5, 16.049999999999997, 16.949999999999996, 16.950000000000003, 17.75, 16.85, 17.950000000000003, 18.15, 17.699999999999996, 17.250000000000004, 15.600000000000003, 14.699999999999998, 12.850000000000003, 12.499999999999996, 11.25, 11.3, 11.95, 10.499999999999998, 9.450000000000001, 8.700000000000001, 8.8, 8.150000000000002, 8.15, 7.749999999999999, 7.549999999999999, 7.3, 7.9, 7.4, 6.300000000000002, 6.750000000000001, 6.65, 6.55, 5.550000000000002, 5.550000000000002, 6.300000000000001, 7.250000000000002, 8.200000000000001, 9.3, 9.05, 9.150000000000002, 9.299999999999999, 8.899999999999999, 9.099999999999998, 8.8, 9.25, 9.65, 9.799999999999999, 9.3, 9.599999999999998, 9.65, 10.5, 11.200000000000001, 11.350000000000001, 11.799999999999999, 12.450000000000001, 13.55, 13.450000000000001, 13.5, 14.05, 14.950000000000001, 15.349999999999998, 15.95, 16.75, 16.650000000000002, 17.250000000000004, 17.700000000000003, 18.4, 18.15, 19.0, 19.950000000000003, 20.55, 20.999999999999996, 21.900000000000002, 21.15, 20.1, 20.0, 17.849999999999998, 17.650000000000002, 17.4, 17.700000000000003, 17.4, 17.55, 16.200000000000003, 15.700000000000001, 14.35, 13.8, 13.200000000000001, 12.899999999999999, 15.000000000000004, 14.800000000000002, 14.9, 13.249999999999998, 12.099999999999998, 10.850000000000001, 10.000000000000002, 8.499999999999998, 7.199999999999999, 6.449999999999999, 6.65, 7.049999999999999, 5.800000000000001, 5.050000000000001, 3.4000000000000004, 3.2499999999999982, 2.0999999999999988, 0.8999999999999986, 1.1500000000000004, 0.8499999999999996, 1.0999999999999996, 1.6500000000000004, 1.1500000000000004, -0.1999999999999993, 0.34999999999999964, 0.40000000000000036, 1.1500000000000004, 1.549999999999999, 2.4499999999999993, 3.3999999999999986, 4.300000000000001, 5.1, 5.3999999999999995, 5.199999999999999, 4.9, 5.1000000000000005, 4.800000000000001, 4.949999999999999, 5.1499999999999995, 5.049999999999999, 4.949999999999999, 4.55, 3.95, 4.05, 4.3500000000000005, 4.250000000000001, 4.499999999999999, 4.299999999999999, 4.0, 3.8499999999999996, 3.5500000000000007, 3.700000000000001, 4.25, 4.699999999999999, 5.1499999999999995, 3.45, 2.249999999999999, 1.3000000000000007, 1.0499999999999998, 1.5, 1.4000000000000004, 1.5, 1.7000000000000002, 1.25, 1.0499999999999998, 1.0500000000000007, 1.6500000000000004, 2.5500000000000007, 3.9000000000000004, 5.3999999999999995, 5.55, 5.3500000000000005, 5.75, 6.449999999999999, 6.7, 6.75, 6.95, 6.9, 6.3, 6.1499999999999995, 6.1499999999999995, 6.449999999999999, 6.25, 6.6, 6.749999999999999, 6.4, 6.9, 6.9, 7.000000000000001, 7.300000000000001, 7.65, 7.999999999999999, 8.5, 8.45, 8.900000000000002, 8.5, 8.3, 7.8500000000000005, 7.1499999999999995, 7.45, 7.65, 7.499999999999999, 8.4, 8.649999999999999, 8.600000000000001, 7.65, 7.2, 7.8500000000000005, 7.699999999999999, 8.7, 9.4, 9.549999999999999, 9.25, 8.849999999999998, 8.15, 7.35, 6.550000000000002, 6.650000000000001, 6.6, 6.15, 5.800000000000001, 4.799999999999999, 4.199999999999999, 3.3499999999999996, 3.5, 3.3500000000000005, 2.6000000000000005, 2.799999999999999, 3.4000000000000004, 3.4000000000000004, 2.9000000000000004, 2.8500000000000005, 3.1000000000000005, 3.0500000000000007, 2.9000000000000004, 3.500000000000001, 3.0999999999999996, 2.9499999999999993, 3.6499999999999995, 3.700000000000001, 3.6500000000000004, 3.700000000000001, 3.700000000000001, 3.5, 3.299999999999999, 3.3999999999999995, 3.3500000000000005, 3.3999999999999995, 3.450000000000001, 3.5500000000000007, 3.1500000000000004, 3.1500000000000004, 3.25, 3.1999999999999993, 3.3499999999999996, 3.6500000000000004, 4.1, 4.35, 4.6, 4.1000000000000005, 4.450000000000001, 4.550000000000001, 4.6, 4.949999999999999, 4.949999999999999, 4.8500000000000005, 5.200000000000001, 4.9, 4.499999999999999, 4.2, 4.15, 4.699999999999999, 4.300000000000001, 4.15, 4.450000000000001, 4.550000000000001, 4.699999999999999, 4.75, 4.75, 4.8999999999999995, 5.0, 5.25, 5.3, 5.3, 5.549999999999999, 5.549999999999999, 5.2, 5.3, 4.999999999999999, 4.65, 4.4, 4.449999999999999, 4.4, 4.500000000000001, 4.4, 4.45, 4.1000000000000005, 3.8499999999999996, 3.8000000000000007, 3.5, 3.3999999999999995, 3.8, 4.1499999999999995, 4.05, 4.05, 3.9000000000000004, 3.6500000000000004, 3.75, 3.8499999999999996, 4.0, 4.25, 4.0, 4.35, 5.1499999999999995, 4.95, 4.7, 4.8500000000000005, 5.249999999999999, 5.7, 5.800000000000001, 5.800000000000001, 6.050000000000001, 6.050000000000001, 6.700000000000001, 7.699999999999999, 6.8500000000000005, 6.800000000000001, 7.550000000000001, 7.550000000000001, 7.0, 7.35, 7.199999999999999, 7.199999999999999, 7.199999999999999, 7.3500000000000005, 7.05, 6.05, 6.549999999999999, 7.1000000000000005, 6.300000000000001, 5.450000000000001, 5.15, 4.9, 3.8500000000000005, 3.3499999999999996, 2.7, 1.9500000000000002, 1.9500000000000002, 2.55, 2.5, 2.0, 1.8500000000000005, 2.45, 3.0, 2.55, 3.3, 3.4000000000000004, 3.5999999999999996, 4.1000000000000005, 4.6, 4.6, 3.3000000000000007, 3.0500000000000007, 2.8500000000000005, 2.95, 3.200000000000001, 3.3499999999999996, 3.0, 2.9000000000000004, 3.1499999999999995, 3.1499999999999995, 2.95, 2.75, 3.8499999999999996, 5.050000000000001, 5.35, 5.0, 4.65, 4.35, 5.300000000000001, 5.85, 5.549999999999999, 5.2, 5.1, 5.45, 6.05, 5.1, 4.75, 5.800000000000001, 6.5, 8.05, 7.449999999999999, 6.25, 6.199999999999999, 7.3, 6.6000000000000005, 6.3999999999999995, 6.55, 7.700000000000001, 7.85, 7.449999999999999, 6.999999999999999, 4.65, 3.55, 4.5, 5.35, 4.550000000000001, 5.1, 5.799999999999999, 5.4, 5.65, 5.450000000000001, 4.8999999999999995, 4.4, 5.499999999999999, 6.55, 7.749999999999999, 7.1499999999999995, 7.449999999999999, 7.1, 6.9, 6.85, 6.9, 7.9, 8.599999999999998, 8.000000000000002, 7.250000000000002, 5.050000000000001, 0.8500000000000005, -1.15, -1.7999999999999998, -2.000000000000001, -3.2999999999999994, -4.05, -5.3500000000000005, -5.6, -6.65, -5.85, -5.750000000000001, -4.3, -1.2000000000000002, 0.15000000000000036, 0.09999999999999964, -0.6500000000000004, -0.45000000000000107, -0.5999999999999996, -0.5999999999999996, -1.75, -1.6000000000000005, -1.8499999999999996, -1.8499999999999996, -1.6000000000000005, -2.1500000000000004, -1.0500000000000007, -0.6999999999999993, 0.15000000000000036, 1.0500000000000007, 1.700000000000001, 2.4000000000000004, 2.3000000000000007, 2.4000000000000004, 2.6999999999999993, 2.8499999999999996, 2.4499999999999993, 2.5, 2.0, 2.049999999999999, 2.049999999999999, 1.8500000000000014, 1.25, 0.35000000000000053, 0.35000000000000053, -0.09999999999999964, 0.4500000000000002, 1.2000000000000002, 1.5000000000000009, 1.0, 0.6499999999999995, 0.40000000000000036, 1.2999999999999998, 0.75, 0.05000000000000071, 0.5999999999999996, 1.2000000000000002, 1.7000000000000002, 1.0499999999999998, 0.5999999999999996, 0.2999999999999998, 0.8999999999999995, 1.5499999999999998, 1.8000000000000007, 0.9500000000000002, 1.5499999999999998, 2.7, 2.8500000000000005, 3.0500000000000007, 2.8, 2.3499999999999996, 2.6499999999999995, 2.8499999999999996, 2.1500000000000004, 1.6000000000000005, 0.1499999999999998, 0.5, 0.35, 0.2999999999999996, 0.5, 0.8500000000000001, 1.0999999999999999, 1.2000000000000004, 1.0, 1.3, 1.75, 2.05, 3.1999999999999993, 2.5999999999999996, 2.35, 2.6500000000000004, 2.8, 2.5999999999999996, 2.3, 2.75, 3.25, 3.5, 3.95, 4.45, 4.95, 5.3500000000000005, 5.1, 4.9, 4.55, 4.1000000000000005, 4.25, 4.449999999999999, 5.1000000000000005, 4.9, 5.200000000000001, 5.050000000000001, 5.050000000000001]
print(len(tays))
# add recession shading
plt.axvspan(1957+7/12, 1958+3/12, color='#808080', alpha=0.5, lw=0)
plt.axvspan(1960+3/12, 1961+1/12, color='#808080', alpha=0.5, lw=0)
plt.axvspan(1969+11/12, 1970+10/12, color='#808080', alpha=0.5, lw=0)
plt.axvspan(1973+10/12, 1975+2/12, color='#808080', alpha=0.5, lw=0)
plt.axvspan(1980+0/12, 1980+6/12, color='#808080', alpha=0.5, lw=0)
plt.axvspan(1981+6/12, 1982+10/12, color='#808080', alpha=0.5, lw=0)
plt.axvspan(1990+6/12, 1991+2/12, color='#808080', alpha=0.5, lw=0)
plt.axvspan(2001+2/12, 2001+10/12, color='#808080', alpha=0.5, lw=0)
plt.axvspan(2007+11/12, 2009+5/12, color='#808080', alpha=0.5, lw=0)

plt.plot(data,ground_truths, color='black', linewidth=1)
plt.plot(data,predicted_rates, color='red', linewidth=0.5)
# plt.plot(data,tays, color='blue', linewidth=0.5)
plt.title("Federal Funds Rate and Neural Network Output")
plt.ylabel("Federal Funds Rate (%)")
plt.xlabel("Years")
plt.show()